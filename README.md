# arkadius-bot

Карл — Telegram бот, написанный на TypeScript. Он использует ChatGPT 4o и отвечает в групповых чатах при упоминании или ответе на его сообщение.

## Возможности

- Команда `/start` выводит приветствие.
- `/ping` просто отвечает `pong`.
- `/reset` сбрасывает память диалога.
- Откликается, если его упомянут, ответят на сообщение бота или начнут сообщение с имени Карл.
- Может откликаться на ключевые слова из `keywords.json`.
- Запоминает предыдущие сообщения в SQLite и суммирует длинные чаты для сохранения контекста.
- Персона бота описана в `persona.md`.

## Установка

1. Установите зависимости:
   ```bash
   npm install
   ```
2. Создайте `.env` с токенами Telegram и OpenAI:
   ```
   BOT_TOKEN=your-telegram-token
   OPENAI_API_KEY=your-openai-key
   ```
3. Запустите в режиме разработки:
   ```bash
   npm run dev
   ```
4. Собрайте проект:
   ```bash
   npm run build
   ```
5. Примените миграции БД:
   ```bash
   npm run migration:up
   ```
6. Запустите собранную версию:
   ```bash
   npm start
   ```

Для проверки типов и тестов можно выполнить:

```bash
npm exec tsc
npm test
```

## Структура проекта

- `src/index.ts` — точка входа приложения.
- `src/bot/TelegramBot.ts` — логика бота и обработка сообщений.
- `src/services/ChatGPTService.ts` — взаимодействие c OpenAI.
- `src/services/ChatMemory.ts` — хранение истории и ее суммаризация.
- `dist/` — собранные файлы.

Репозиторий полностью базируется на npm и TypeScript.
