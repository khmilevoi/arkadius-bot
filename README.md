# arkadius-bot

Карл — Telegram клиент, написанный на TypeScript. Он использует ChatGPT 4o и отвечает в групповых чатах при упоминании или ответе на его сообщение.

## Возможности

- Команда `/start` выводит приветствие.
- `/ping` просто отвечает `pong`.
- `/reset` сбрасывает память диалога.
- Откликается, если его упомянут, ответят на сообщение клиента или начнут сообщение с имени Карл.
- Может откликаться на ключевые слова из `keywords.txt`.
- Запоминает предыдущие сообщения в SQLite и суммирует длинные чаты для сохранения контекста.
- Персона клиента описана в `persona.md`.

## Установка

1. Установите зависимости:
   ```bash
   npm install
   ```
2. Создайте `.env` с токенами Telegram и OpenAI. Для чтения пересланных сообщений также понадобятся параметры клиентского API Telegram:
   ```
   OPENAI_API_KEY=your-openai-key
   TG_API_ID=your-api-id
   TG_API_HASH=your-api-hash
   TG_SESSION=your-session-string
   ```
3. Запустите в режиме разработки:
   ```bash
   npm run dev
   ```
4. Собрайте проект:
   ```bash
   npm run build
   ```
5. Запустите собранную версию:
   ```bash
   npm start
   ```

Для проверки типов и тестов можно выполнить:

```bash
npm exec tsc
npm test
```

## Структура проекта

- `src/index.ts` — точка входа приложения.
- `src/client/TelegramClient.ts` — логика клиента и обработка сообщений.
- `src/services/ChatGPTService.ts` — взаимодействие c OpenAI.
- `src/services/ChatMemory.ts` — хранение истории и ее суммаризация.
- `dist/` — собранные файлы.

Репозиторий полностью базируется на npm и TypeScript.
